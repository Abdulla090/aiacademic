import React, { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Textarea } from '@/components/ui/textarea';
import { toast } from 'sonner';
import { KurdishPDFService } from '@/services/kurdishPdfService';

const KurdishPDFTest: React.FC = () => {
  const [isGenerating, setIsGenerating] = useState(false);
  const [testResults, setTestResults] = useState<string[]>([]);

  // Prepared test texts - Kurdish and Arabic for comparison
  const testTexts = {
    basic: `Ø³ÚµØ§Ùˆ Ù„Û• Ù‡Û•Ù…ÙˆØ§Ù†ØªØ§Ù†! Ø¦Û•Ù…Û• ØªØ§Ù‚ÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒÛ•Ú©Û• Ø¨Û† Ù†ÙˆÙˆØ³ÛŒÙ†ÛŒ Ú©ÙˆØ±Ø¯ÛŒ.`,
    
    arabic: `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…! Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙÙŠ Ù…Ù„Ù PDF.`,
    
    comprehensive: `## Ù¾ÛÙ†Ø§Ø³Û•ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯ (AI): Ú†Û•Ù…Ú© Ùˆ Ø¨Ù†Û•Ù…Ø§Ú©Ø§Ù†

Ø¦Û•Ù… Ø¨Û•Ø´Û• ØªÛŒØ´Ú© Ø¯Û•Ø®Ø§ØªÛ• Ø³Û•Ø± Ú†Û•Ù…Ú© Ùˆ Ø¨Ù†Û•Ù…Ø§ Ø³Û•Ø±Û•Ú©ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯ (AI). 

### ØªØ§ÛŒØ¨Û•ØªÙ…Û•Ù†Ø¯ÛŒÛŒÛ•Ú©Ø§Ù†ÛŒ Ú©ÙˆØ±Ø¯ÛŒ:
- Ú•Û•Ø´Û•Ú©Û•: Ú•
- Û† (ÙˆØ§Ùˆ): Û†  
- Ú¤Û•Ú©Ø§Ù†: Ú¤
- ÚµØ§Ù…Ø§Ú©Ø§Ù†: Úµ
- ÛÚ©Ø§Ø±Û•Ú©Ø§Ù†: Û
- Û•Ù‡Û•ÛŒ Ú©ÙˆØ±Øª: Û•
- Ú†ÛŒÙ…Û•Ù†: Ú†
- Ù¾ÛÚ©Ø§Ù†: Ù¾
- Ú¯Û•ÚµØ§Ú©Ø§Ù†: Ú¯
- Ú˜ÛŒØ§Ù†: Ú˜

*Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯ Ø¨Û•Ú¯Ø´ØªÛŒ ÙˆÛ•Ú© ØªÙˆØ§Ù†Ø§ÛŒ Ø¦Ø§Ù…ÛØ±ÛÚ© Ø¨Û† Ù„Ø§Ø³Ø§ÛŒÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ ØªÙˆØ§Ù†Ø§ Ù…Ø±Û†ÛŒÛŒÛ•Ú©Ø§Ù† Ù¾ÛÙ†Ø§Ø³Û• Ø¯Û•Ú©Ø±ÛØª.*

> **Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯ Ø¨Ø±ÛŒØªÛŒÛŒÛ• Ù„Û• Ù‡Û•ÙˆÚµØ¯Ø§Ù† Ø¨Û† Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†ÛŒ Ø¦Ø§Ù…ÛØ±Ú¯Û•Ù„ÛÚ© Ú©Û• Ø¨ØªÙˆØ§Ù†Ù† Ø¨ÛŒØ± Ø¨Ú©Û•Ù†Û•ÙˆÛ•ØŒ ÙÛØ± Ø¨Ø¨Ù†ØŒ Ùˆ Ú©ÛØ´Û•Ú©Ø§Ù† Ú†Ø§Ø±Û•Ø³Û•Ø± Ø¨Ú©Û•Ù† ÙˆÛ•Ú© Ù…Ø±Û†Ú¤.**`,

    arabicComprehensive: `## ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… ÙˆØ§Ù„Ø£Ø³Ø³

Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙŠØ³Ù„Ø· Ø§Ù„Ø¶ÙˆØ¡ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… ÙˆØ§Ù„Ø£Ø³Ø³ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.

### Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ:
- Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: Ø§ Ø¨ Øª Ø« Ø¬ Ø­ Ø® Ø¯ Ø° Ø± Ø² Ø³ Ø´ Øµ Ø¶ Ø· Ø¸ Ø¹ Øº Ù Ù‚ Ùƒ Ù„ Ù… Ù† Ù‡ Ùˆ ÙŠ
- Ø§Ù„ØªØ´ÙƒÙŠÙ„: Ù Ù Ù Ù‹ Ù ÙŒ Ù‘ Ù’
- Ø§Ù„Ø§ØªØ¬Ø§Ù‡: Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±

*Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠÙØ¹Ø±ÙÙ‘Ù Ø¹Ù…ÙˆÙ…Ù‹Ø§ ÙƒÙ‚Ø¯Ø±Ø© Ø§Ù„Ø¢Ù„Ø© Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø§Ù„Ø¨Ø´Ø±ÙŠØ©.*

> **Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù‡Ùˆ Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¢Ù„Ø§Øª ÙŠÙ…ÙƒÙ†Ù‡Ø§ Ø§Ù„ØªÙÙƒÙŠØ± ÙˆØ§Ù„ØªØ¹Ù„Ù… ÙˆØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª Ù…Ø«Ù„ Ø§Ù„Ø¨Ø´Ø±.**`,

    special: `### ØªÛ•Ú©Ù†Û•Ù„Û†Ú˜ÛŒØ§ÛŒ Ù†ÙˆÛ:
1. **ÙÛØ±Ø¨ÙˆÙˆÙ†ÛŒ Ø¦Ø§Ù…ÛØ±ÛŒ (Machine Learning)**
2. **Ù¾Ø±Û†Ø³ÛØ³Ú©Ø±Ø¯Ù†ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ø³Ø±ÙˆØ´ØªÛŒ (NLP)**  
3. **Ø¨ÛŒÙ†ÛŒÙ†ÛŒ Ú©Û†Ù…Ù¾ÛŒÙˆØªÛ•Ø±ÛŒ (Computer Vision)**
4. **Ú•Û†Ø¨Û†ØªÛŒÚ© (Robotics)**

Ú©ÙˆØ±Ø¯Ø³ØªØ§Ù†ØŒ Ø¨Û•ØºØ¯Ø§Ø¯ØŒ Ù‡Û•ÙˆÙ„ÛØ±ØŒ Ø³Ù„ÛÙ…Ø§Ù†ÛŒØŒ Ø¯Ù‡Û†Ú©
Ø¦Û•Ú¤ÛŒÙ†ØŒ Ø®Û†Ø´Û•ÙˆÛŒØ³ØªÛŒØŒ Ú•ÛØ²Ú¯Ø±ØªÙ†ØŒ Ø¯Û†Ø³ØªØ§ÛŒÛ•ØªÛŒ`,

    arabicSpecial: `### Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø©:
1. **Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ (Machine Learning)**
2. **Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© (NLP)**
3. **Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ÙŠØ© (Computer Vision)**
4. **Ø§Ù„Ø±ÙˆØ¨ÙˆØªØ§Øª (Robotics)**

Ø§Ù„Ø¹Ø±Ø§Ù‚ØŒ Ø¨ØºØ¯Ø§Ø¯ØŒ Ø£Ø±Ø¨ÙŠÙ„ØŒ Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©ØŒ Ø¯Ù‡ÙˆÙƒ
Ø§Ù„Ø­Ø¨ØŒ Ø§Ù„Ù…ÙˆØ¯Ø©ØŒ Ø§Ù„Ø§Ø­ØªØ±Ø§Ù…ØŒ Ø§Ù„ØµØ¯Ø§Ù‚Ø©`
  };

  const addTestResult = (message: string) => {
    const timestamp = new Date().toLocaleTimeString();
    setTestResults(prev => [...prev, `[${timestamp}] ${message}`]);
  };

  const testBasicPDF = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ§ª Starting Basic Kurdish PDF Test...');
      
      const pdfService = new KurdishPDFService();
      
      // Load Kurdish fonts
      addTestResult('ğŸ“œ Loading Kurdish fonts...');
      const loadedFont = await pdfService.loadKurdishFontsWithFallback();
      addTestResult(`âœ… Font loaded: ${loadedFont}`);
      
      const doc = pdfService.getDoc();
      doc.setFontSize(16);
      
      // Test basic text
      addTestResult('ğŸ“ Adding basic Kurdish text...');
      addTestResult(`Text to add: ${testTexts.basic}`);
      
      pdfService.addKurdishText(testTexts.basic, 20, 30);
      
      // Save PDF
      const filename = `kurdish-test-basic-${Date.now()}.pdf`;
      pdfService.save(filename);
      
      addTestResult(`âœ… Basic PDF generated: ${filename}`);
      toast.success('Basic Kurdish PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ Basic test failed: ${errorMsg}`);
      toast.error('Basic test failed: ' + errorMsg);
      console.error('Basic test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  const testComprehensivePDF = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ§ª Starting Comprehensive Kurdish PDF Test...');
      
      const pdfService = new KurdishPDFService();
      
      // Load Kurdish fonts
      addTestResult('ğŸ“œ Loading Kurdish fonts...');
      const loadedFont = await pdfService.loadKurdishFontsWithFallback();
      addTestResult(`âœ… Font loaded: ${loadedFont}`);
      
      const doc = pdfService.getDoc();
      
      // Test comprehensive text with formatting
      addTestResult('ğŸ“ Adding comprehensive Kurdish text with formatting...');
      
      // Title
      doc.setFontSize(18);
      addTestResult('Adding title: ØªÛ•Ú©Ù†Û•Ù„Û†Ú˜ÛŒØ§ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯');
      pdfService.addKurdishText('ØªÛ•Ú©Ù†Û•Ù„Û†Ú˜ÛŒØ§ÛŒ Ø²ÛŒØ±Û•Ú©ÛŒ Ø¯Û•Ø³ØªÚ©Ø±Ø¯', 20, 30);
      
      // Content
      doc.setFontSize(12);
      const lines = testTexts.comprehensive.split('\n').filter(line => line.trim());
      let yPosition = 50;
      
      for (const line of lines) {
        if (line.trim()) {
          addTestResult(`Adding line: ${line.substring(0, 50)}...`);
          pdfService.addKurdishText(line.trim(), 20, yPosition);
          yPosition += 15;
          
          // Add new page if needed
          if (yPosition > 270) {
            doc.addPage();
            yPosition = 30;
          }
        }
      }
      
      // Save PDF
      const filename = `kurdish-test-comprehensive-${Date.now()}.pdf`;
      pdfService.save(filename);
      
      addTestResult(`âœ… Comprehensive PDF generated: ${filename}`);
      toast.success('Comprehensive Kurdish PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ Comprehensive test failed: ${errorMsg}`);
      toast.error('Comprehensive test failed: ' + errorMsg);
      console.error('Comprehensive test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  const testArabicPDF = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ‡¸ğŸ‡¦ Starting Arabic PDF Test...');
      
      const pdfService = new KurdishPDFService();
      
      // Load fonts (should work for Arabic too)
      addTestResult('ğŸ“œ Loading fonts for Arabic...');
      const loadedFont = await pdfService.loadKurdishFontsWithFallback();
      addTestResult(`âœ… Font loaded: ${loadedFont}`);
      
      const doc = pdfService.getDoc();
      doc.setFontSize(16);
      
      // Test basic Arabic text
      addTestResult('ğŸ“ Adding basic Arabic text...');
      addTestResult(`Arabic text to add: ${testTexts.arabic}`);
      
      pdfService.addKurdishText(testTexts.arabic, 20, 30);
      
      // Save PDF
      const filename = `arabic-test-basic-${Date.now()}.pdf`;
      pdfService.save(filename);
      
      addTestResult(`âœ… Arabic PDF generated: ${filename}`);
      toast.success('Arabic PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ Arabic test failed: ${errorMsg}`);
      toast.error('Arabic test failed: ' + errorMsg);
      console.error('Arabic test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  const testComprehensiveArabicPDF = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ‡¸ğŸ‡¦ Starting Comprehensive Arabic PDF Test...');
      
      const pdfService = new KurdishPDFService();
      
      // Load fonts
      addTestResult('ğŸ“œ Loading fonts for Arabic...');
      const loadedFont = await pdfService.loadKurdishFontsWithFallback();
      addTestResult(`âœ… Font loaded: ${loadedFont}`);
      
      const doc = pdfService.getDoc();
      
      // Test comprehensive Arabic text with formatting
      addTestResult('ğŸ“ Adding comprehensive Arabic text with formatting...');
      
      // Title
      doc.setFontSize(18);
      addTestResult('Adding Arabic title: ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ');
      pdfService.addKurdishText('ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', 20, 30);
      
      // Content
      doc.setFontSize(12);
      const lines = testTexts.arabicComprehensive.split('\n').filter(line => line.trim());
      let yPosition = 50;
      
      for (const line of lines) {
        if (line.trim()) {
          addTestResult(`Adding Arabic line: ${line.substring(0, 50)}...`);
          pdfService.addKurdishText(line.trim(), 20, yPosition);
          yPosition += 15;
          
          // Add new page if needed
          if (yPosition > 270) {
            doc.addPage();
            yPosition = 30;
          }
        }
      }
      
      // Save PDF
      const filename = `arabic-test-comprehensive-${Date.now()}.pdf`;
      pdfService.save(filename);
      
      addTestResult(`âœ… Comprehensive Arabic PDF generated: ${filename}`);
      toast.success('Comprehensive Arabic PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ Comprehensive Arabic test failed: ${errorMsg}`);
      toast.error('Comprehensive Arabic test failed: ' + errorMsg);
      console.error('Comprehensive Arabic test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  const testCharacterSpecific = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ§ª Starting Character-Specific Kurdish PDF Test...');
      
      const pdfService = new KurdishPDFService();
      
      // Load Kurdish fonts
      addTestResult('ğŸ“œ Loading Kurdish fonts...');
      const loadedFont = await pdfService.loadKurdishFontsWithFallback();
      addTestResult(`âœ… Font loaded: ${loadedFont}`);
      
      const doc = pdfService.getDoc();
      doc.setFontSize(14);
      
      // Test each Kurdish-specific character individually
      const kurdishChars = ['Ú•', 'Û†', 'Ú¤', 'Úµ', 'Û', 'Û•', 'Ú†', 'Ù¾', 'Ú¯', 'Ú˜'];
      let yPosition = 30;
      
      addTestResult('ğŸ”¤ Testing individual Kurdish characters...');
      
      for (const char of kurdishChars) {
        const testLine = `${char} - ØªØ§Ù‚ÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ù¾ÛŒØªÛŒ ${char} Ù„Û• ÙˆØ´Û•ÛŒ Ù†Ù…ÙˆÙˆÙ†Û•Ø¯Ø§: ${char}Û•Ú©Ø§Ù†`;
        addTestResult(`Testing character: ${char}`);
        pdfService.addKurdishText(testLine, 20, yPosition);
        yPosition += 20;
      }
      
      // Test special character combinations
      yPosition += 10;
      pdfService.addKurdishText('--- ØªÛÚ©Û•ÚµÛŒ Ù¾ÛŒØªÛ• ØªØ§ÛŒØ¨Û•ØªÛ•Ú©Ø§Ù† ---', 20, yPosition);
      yPosition += 20;
      
      const combinations = [
        'Ú•Û†Ú˜Ú¯Ø§Ø±ÛŒ Ù†ÙˆÛ',
        'Ú¤ÛŒØ¯ÛŒÛ†ÛŒ Ø¬ÙˆØ§Ù†', 
        'ÚµÛ•Ú¯Û•Úµ Ù‡Ø§ÙˆÚ•ÛÚ©Ø§Ù†',
        'ÛÙˆØ§Ø±Û•ÛŒ Ø®Û†Ø´',
        'Û•ÙˆÛ• Ø¨Û† Ø¦Û•ÙˆÛ•',
        'Ú†ÛŒØ±Û†Ú©ÛŒ Ú©ÙˆØ±Ø¯',
        'Ù¾ÛÚ©Û•Ù†ÛŒÙ†ÛŒ Ø²Û†Ø±',
        'Ú¯Û•Ø´ØªÛŒ Ø¯ÙˆÙˆØ±',
        'Ú˜ÛŒØ§Ù†ÛŒ Ø¨Ø§Ø´'
      ];
      
      for (const combo of combinations) {
        addTestResult(`Testing combination: ${combo}`);
        pdfService.addKurdishText(combo, 20, yPosition);
        yPosition += 15;
      }
      
      // Save PDF
      const filename = `kurdish-test-characters-${Date.now()}.pdf`;
      pdfService.save(filename);
      
      addTestResult(`âœ… Character-specific PDF generated: ${filename}`);
      toast.success('Character-specific Kurdish PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ Character test failed: ${errorMsg}`);
      toast.error('Character test failed: ' + errorMsg);
      console.error('Character test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  // WORKING Kurdish PDF with YOUR font
  const testWorkingKurdishPDF = async () => {
    setIsGenerating(true);
    
    try {
      console.log('ğŸ¯ TESTING WORKING Kurdish PDF with YOUR font');
      addTestResult('ğŸ¯ WORKING Kurdish PDF - using YOUR UniSalar_F_095.otf');
      
      const title = 'ØªØ§Ù‚ÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú©ÙˆØ±Ø¯ÛŒ';
      const content = `Ø³ÚµØ§Ùˆ Ù„Û• Ù‡Û•Ù…ÙˆØ§Ù†ØªØ§Ù†! Ø¦Û•Ù…Û• ØªØ§Ù‚ÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒÛ•Ú©Û• Ø¨Û† Ù†ÙˆÙˆØ³ÛŒÙ†ÛŒ Ú©ÙˆØ±Ø¯ÛŒ.
Ú©ÙˆØ±Ø¯ÛŒ Ø³Û†Ø±Ø§Ù†ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ù†Û•ØªÛ•ÙˆÛ•ÛŒÛŒ Ú©ÙˆØ±Ø¯Û•.
Ú•Û†Ú˜Ú¯Ø§Ø± Ù¾Ú• Ù„Û• Ù‡Û•ÙˆÙ„ÛÚ©ÛŒ Ø²Ø§Ù†Ø³ØªÛŒÛ•.
Ú• Û† Ú¤ Úµ Û Û• Ú† Ù¾ Ú¯ Ú˜`;
      
      addTestResult('ğŸ“ Loading YOUR UniSalar_F_095.otf font...');
      
      await createKurdishPDFWithYourFont(title, content, 'WORKING-kurdish.pdf');
      
      toast.success('ğŸ‰ WORKING Kurdish PDF created with YOUR font!');
      addTestResult('âœ… SUCCESS: PDF created with YOUR UniSalar font');
      addTestResult('ğŸ“ File saved as: WORKING-kurdish.pdf');
      
    } catch (error) {
      console.error('âŒ WORKING test failed:', error);
      toast.error(`WORKING test failed: ${error.message}`);
      addTestResult(`âŒ WORKING test failed: ${error.message}`);
    } finally {
      setIsGenerating(false);
    }
  };

  // ULTIMATE DIRECT TEST - Zero processing
  const testUltimateDirectKurdish = async () => {
    setIsGenerating(true);
    
    try {
      console.log('ğŸš¨ ULTIMATE DIRECT TEST');
      addTestResult('ğŸš¨ ULTIMATE DIRECT TEST - Zero processing, pure jsPDF + your font');
      
      const result = await testDirectKurdish();
      
      if (result) {
        toast.success('ğŸ‰ ULTIMATE test completed! Check ULTIMATE-direct-test.pdf');
        addTestResult('âœ… ULTIMATE test: PDF generated with ZERO text processing');
        addTestResult('ğŸ“ File: ULTIMATE-direct-test.pdf');
      } else {
        toast.error('âŒ ULTIMATE test failed');
        addTestResult('âŒ ULTIMATE test failed - check console');
      }
      
    } catch (error) {
      console.error('âŒ ULTIMATE test error:', error);
      toast.error(`ULTIMATE test error: ${error.message}`);
      addTestResult(`âŒ ULTIMATE test error: ${error.message}`);
    } finally {
      setIsGenerating(false);
    }
  };

  // Test DIRECT Kurdish PDF (bypasses all jsPDF processing)
  const testDirectKurdishPDF = async () => {
    setIsGenerating(true);
    
    try {
      console.log('ğŸš¨ TESTING DIRECT Kurdish PDF approach');
      addTestResult('ğŸš¨ Starting DIRECT Kurdish PDF test (bypassing ALL jsPDF processing)...');
      
      const directPdf = new DirectKurdishPDF();
      
      const testText = `Ø³ÚµØ§Ùˆ Ù„Û• Ù‡Û•Ù…ÙˆØ§Ù†ØªØ§Ù†! Ø¦Û•Ù…Û• ØªØ§Ù‚ÛŒÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒÛ•Ú©Û• Ø¨Û† Ù†ÙˆÙˆØ³ÛŒÙ†ÛŒ Ú©ÙˆØ±Ø¯ÛŒ.
Ú©ÙˆØ±Ø¯ÛŒ Ø³Û†Ø±Ø§Ù†ÛŒ Ø²Ù…Ø§Ù†ÛŒ Ù†Û•ØªÛ•ÙˆÛ•ÛŒÛŒ Ú©ÙˆØ±Ø¯Û•.
Ú•Û†Ú˜Ú¯Ø§Ø± Ù¾Ú• Ù„Û• Ù‡Û•ÙˆÙ„ÛÚ©ÛŒ Ø²Ø§Ù†Ø³ØªÛŒÛ•.
Ú• Û† Ú¤ Úµ Û Û• Ú† Ù¾ Ú¯ Ú˜`;
      
      addTestResult('ğŸ¯ Loading YOUR UniSalar font directly...');
      await directPdf.createTestPDF(testText);
      directPdf.save('DIRECT-kurdish-test.pdf');
      
      toast.success('ğŸš¨ DIRECT Kurdish PDF created! Check the download.');
      addTestResult('âœ… DIRECT approach: PDF generated without ANY jsPDF text processing');
      addTestResult('ğŸ“ File saved as: DIRECT-kurdish-test.pdf');
      
    } catch (error) {
      console.error('âŒ DIRECT test failed:', error);
      toast.error(`DIRECT test failed: ${error.message}`);
      addTestResult(`âŒ DIRECT approach failed: ${error.message}`);
    } finally {
      setIsGenerating(false);
    }
  };

  const testHTMLToPDF = async () => {
    try {
      setIsGenerating(true);
      addTestResult('ğŸ†• Starting HTML-to-PDF Kurdish Test...');
      
      addTestResult('ğŸ“ Using HTML rendering approach...');
      await AlternativeKurdishPDF.generateFromHTML(testTexts.basic);
      
      addTestResult('âœ… HTML-based PDF generated successfully!');
      toast.success('HTML-based Kurdish PDF test completed!');
      
    } catch (error) {
      const errorMsg = error instanceof Error ? error.message : 'Unknown error';
      addTestResult(`âŒ HTML test failed: ${errorMsg}`);
      toast.error('HTML test failed: ' + errorMsg);
      console.error('HTML test error:', error);
    } finally {
      setIsGenerating(false);
    }
  };

  const clearResults = () => {
    setTestResults([]);
  };

  return (
    <div className="container mx-auto p-6 max-w-4xl">
      <Card className="mb-6">
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            ğŸ§ª Kurdish PDF Test Laboratory
          </CardTitle>
          <CardDescription>
            Comprehensive testing environment for Kurdish Sorani PDF generation debugging
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          {/* Kurdish Tests */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸ´ Kurdish Tests</h3>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <Button 
                onClick={testBasicPDF}
                disabled={isGenerating}
                className="w-full"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ”¤ Basic Kurdish Test'}
              </Button>
              
              <Button 
                onClick={testComprehensivePDF}
                disabled={isGenerating}
                variant="outline"
                className="w-full"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ“„ Comprehensive Kurdish'}
              </Button>
              
              <Button 
                onClick={testCharacterSpecific}
                disabled={isGenerating}
                variant="secondary"
                className="w-full"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ” Kurdish Characters'}
              </Button>
            </div>
          </div>

          {/* Arabic Tests */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸ‡¸ğŸ‡¦ Arabic Tests (for comparison)</h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <Button 
                onClick={testArabicPDF}
                disabled={isGenerating}
                variant="default"
                className="w-full bg-green-600 hover:bg-green-700"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ”¤ Basic Arabic Test'}
              </Button>
              
              <Button 
                onClick={testComprehensiveArabicPDF}
                disabled={isGenerating}
                variant="outline"
                className="w-full border-green-600 text-green-600 hover:bg-green-50"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ“„ Comprehensive Arabic'}
              </Button>
            </div>
          </div>

          {/* WORKING METHOD WITH YOUR FONT */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸ¯ YOUR FONT - WORKING METHOD</h3>
            <div className="grid grid-cols-1 gap-4">
              <Button 
                onClick={testWorkingKurdishPDF}
                disabled={isGenerating}
                className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ¯ USE YOUR UNISALAR FONT NOW'}
              </Button>
            </div>
          </div>

          {/* ULTIMATE DIRECT METHOD */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸ”¥ ULTIMATE DIRECT TEST</h3>
            <div className="grid grid-cols-1 gap-4">
              <Button 
                onClick={testUltimateDirectKurdish}
                disabled={isGenerating}
                className="w-full bg-orange-600 hover:bg-orange-700"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ”¥ ULTIMATE: Pure jsPDF + Your Font'}
              </Button>
            </div>
          </div>

          {/* Emergency Direct Method */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸš¨ EMERGENCY DIRECT METHOD</h3>
            <div className="grid grid-cols-1 gap-4">
              <Button 
                onClick={testDirectKurdishPDF}
                disabled={isGenerating}
                variant="destructive"
                className="w-full bg-red-600 hover:bg-red-700"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸš¨ DIRECT Kurdish PDF (No Processing)'}
              </Button>
            </div>
          </div>

          {/* Alternative Method */}
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3 text-center">ğŸ†• Alternative Method</h3>
            <div className="grid grid-cols-1 gap-4">
              <Button 
                onClick={testHTMLToPDF}
                disabled={isGenerating}
                variant="outline"
                className="w-full"
              >
                {isGenerating ? 'â³ Testing...' : 'ğŸ†• HTML to PDF Test'}
              </Button>
            </div>
          </div>
          
          <Button 
            onClick={clearResults}
            variant="destructive"
            size="sm"
            className="w-full md:w-auto"
          >
            ğŸ—‘ï¸ Clear Test Results
          </Button>
        </CardContent>
      </Card>

      {/* Test Preview Texts */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <Card>
          <CardHeader>
            <CardTitle className="text-sm">Basic Test Text</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-sm font-mono bg-muted p-3 rounded text-right" dir="rtl">
              {testTexts.basic}
            </div>
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader>
            <CardTitle className="text-sm">Character Test</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-sm font-mono bg-muted p-3 rounded text-right" dir="rtl">
              Ú• Û† Ú¤ Úµ Û Û• Ú† Ù¾ Ú¯ Ú˜
            </div>
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader>
            <CardTitle className="text-sm">Special Combinations</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-sm font-mono bg-muted p-3 rounded text-right" dir="rtl">
              Ú•Û†Ú˜Ú¯Ø§Ø±ØŒ Ú¤ÛŒØ¯ÛŒÛ†ØŒ ÚµÛ•Ú¯Û•ÚµØŒ ÛÙˆØ§Ø±Û•
            </div>
          </CardContent>
        </Card>
      </div>

      {/* Test Results */}
      {testResults.length > 0 && (
        <Card>
          <CardHeader>
            <CardTitle className="text-sm">Test Results Log</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="bg-black text-green-400 p-4 rounded font-mono text-xs max-h-96 overflow-y-auto">
              {testResults.map((result, index) => (
                <div key={index} className="mb-1">
                  {result}
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  );
};

export default KurdishPDFTest;